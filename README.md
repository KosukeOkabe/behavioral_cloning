# 機械学習による自動運転シミュレーション
## 用途
Udacity社が提供している[Self-Driving Car Simulator](https://github.com/udacity/self-driving-car-sim)を用いて得られた画像データから, コースを自動で走るための推論を行うためのプログラムです.  
`end_to_end.py`では得られた画像データとハンドル角度から自動運転のための推論を, `cnn_visualize.py`では学習に用いた畳み込み層で画像のどの部分が学習において抽出されているかを確認できます.

## 準備
上述のシミュレータを録画モードで実行し走行すると, `driving_log.csv`というハンドルの角度や速度を記録しているcsvファイルと走行時の画像を保存した`IMG`というディレクトリが作成され, その中に画像が保存されます.  
`end_to_end.py`では12行目のpathを, `cnn_visualize.py`では17行目のpathをデータの保存場所に変更してください.  
`csv`, `cv2`, `numpy`, `matplotlib`, `keras`のライブラリを使用するので事前にpip等で使用可能にしてください.

## 実行
`end_to_end.py`を実行すると, シミュレータの画像の学習によって得られたデータが`model.h5`という名前で保存されます.  
`cnn_visualize.py`を実行すると, 上で得られたモデルから学習時に画像のどの部分が重要視されているのかを可視化して確認することが出来ます.  